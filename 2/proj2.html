<!DOCTYPE html>
<html>
<head>
    <title> Project 2: Fun with Filters and Frequencies! </title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <a href="../index.html" class="back-button"> Back to Home </a>
    <h1> Project 2: Fun with Filters and Frequencies! </h1>
    <h2> Part 1: Fun with Filters </h2>
    <h3> 1.1 Convolutions from Scratch! </h3>    
    <h4> Convolution Implementation with 4 For-Loops </h4>
    <pre><code>
    def convolve(image, filter):
        # pad the image
        image_padded = np.pad(image, ((filter.shape[0]//2, filter.shape[0]//2), (filter.shape[1]//2, filter.shape[1]//2)))

        # flip filter
        filter = np.flipud(np.fliplr(filter))

        # construct output matrix
        output_x = image_padded.shape[0]-filter.shape[0]+1
        output_y = image_padded.shape[1]-filter.shape[1]+1
        output = np.empty((output_x, output_y))

        # 4 for loops: go through each image square
        for image_x in range(output_x):
            for image_y in range(output_y):
                # go through each filter
                curr_sum = 0
                for filter_x in range(filter.shape[0]):
                    for filter_y in range(filter.shape[1]):
                        curr_sum += image_padded[image_x+filter_x][image_y+filter_y] * filter[filter_x][filter_y]
                output[image_x][image_y] = curr_sum
        return output
    </code></pre>
    <h4> Convolution Implementation with 2 For-Loops </h4>
    <pre><code>
    def convolve2(image, filter):
        # pad the image
        image_padded = np.pad(image, ((filter.shape[0]//2, filter.shape[0]//2), (filter.shape[1]//2, filter.shape[1]//2)))
        
        # flip filter
        filter = np.flipud(np.fliplr(filter))

        # construct output matrix
        output_x = image_padded.shape[0]-filter.shape[0]+1
        output_y = image_padded.shape[1]-filter.shape[1]+1
        output = np.empty((output_x, output_y))

        for image_x in range(output.shape[0]):
            for image_y in range(output.shape[1]):
                curr_sum = np.sum(image_padded[image_x:image_x+filter.shape[0], image_y:image_y+filter.shape[1]] * filter)
                output[image_x][image_y] = curr_sum
        return output
    </code></pre>
        <p>
            The convolution with the 9x9 box filter transformed the originally clear high-resolution image into a blurred version of 
            the image. The convolution using 4 for-loops took the longest time of around 21.36 seconds, using 2 for-loops was much 
            faster, taking 2.35 seconds, but the built-in convolution was the fastest, taking only 0.083 seconds. Despite different 
            implementation approaches of convolution, the output images were largely the same. The only difference was that in the 
            methods using for-loops, the images had a thin black boundary. Meanwhile the built-in 2D convolution has more flexible 
            boundary handling modes. When I initially used convolve2d without specifying the mode, the black boundary was very 
            thick due to the zero padding that accounted for all overlaps. However, my for-loop implementations pads the image such 
            that the output image is the same size as the input, which is equivalent to mode=‘same’. Thus, upon changing convolve2d 
            to ‘same’ mode, the boundaries are now handled the same as my for-loop implementation with a thinner boundary.
        </p>  

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/bonnie.JPG" alt="Image of Me (Bonnie)" style="width: 250px; height: auto;" />
                <figcaption> Original Image </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self.jpg" alt="Image of Me in Grayscale" style="width: 250px; height: auto;" />
                <figcaption> Grayscale Image </figcaption>
            </figure>
        </div>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_convolved_4loops.JPG" alt="9x9 Box Filter w/ 4 For Loops (21.30s)" style="width: 250px; height: auto;" />
                <figcaption> 9x9 Box Filter w/ 4 For-loops (21.30s) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_convolved_2loops.jpg" alt="9x9 Box Filter w/ 4 For Loops (2.44s)" style="width: 250px; height: auto;" />
                <figcaption> 9x9 Box Filter w/ 4 For-loops (2.44s) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_convolved_scipy.jpg" alt="9x9 Box Filter w/ Built-In Convolve2D (0.087s)" style="width: 250px; height: auto;" />
                <figcaption> 9x9 Box Filter w/ Built-In Convolve2D (0.087s) </figcaption>
            </figure>
        </div>
        
        <p>
            For convolution with the Dx and Dy finite difference operators, the output images were the same visually across all 
            implementations methods. However, I was surprised that convolution with 4 for-loops ran faster than the approach with 
            2 for-loops with times of approximately 1.2 seconds compared to 2.2 seconds, respectively. The built-in convolution 
            still remained fastest at around 0.01 seconds.
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_dx_4loops.jpg" alt="Dx w/ 4 For-loops (1.12s)" style="width: 250px; height: auto;" />
                <figcaption> Dx w/ 4 For-loops (1.12s) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_dx_2loops.jpg" alt="Dx w/ 4 For-loops (2.26s)" style="width: 250px; height: auto;" />
                <figcaption> Dx w/ 4 For-loops (2.26s) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_dx_scipy.jpg" alt="Dx w/ 4 Built-In Convolve2D (0.0087s)" style="width: 250px; height: auto;" />
                <figcaption> Dx w/ 4 Built-In Convolve2D (0.0087s) </figcaption>
            </figure>

            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_dy_4loops.jpg" alt="Dy w/ 4 For-loops (1.12s)" style="width: 250px; height: auto;" />
                <figcaption> Dy w/ 4 For-loops (1.22s) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_dy_2loops.jpg" alt="Dy w/ 4 For-loops (2.26s)" style="width: 250px; height: auto;" />
                <figcaption> Dy w/ 4 For-loops (2.18s) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.1/image_self_dy_scipy.jpg" alt="Dy w/ 4 Built-In Convolve2D (0.0087s)" style="width: 250px; height: auto;" />
                <figcaption> Dy w/ 4 Built-In Convolve2D (0.014s) </figcaption>
            </figure>
        </div>

    <h3> 1.2 Finite Difference Operator </h3>
    <div>
        <p> Below is the cameraman image convolved with finite difference operators of Dx and Dy and the resulting gradient image: </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_convolve_dx.jpg" alt="Cameraman convolved with Dx" style="width: 250px; height: auto;" />
                <figcaption> Cameraman convolved w/ Dx </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_convolve_dy.jpg" alt="Cameraman convolved with Dy" style="width: 250px; height: auto;" />
                <figcaption> Cameraman convolved w/ Dy </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_gradient_magnitude.jpg" alt="Cameraman Gradient Magnitude" style="width: 250px; height: auto;" />
                <figcaption> Cameraman Gradient Magnitude </figcaption>
            </figure>
        </div>

        <p>
            To find the best threshold to find the edges of the cameraman image, I tested out a wide range of thresholds from values 10 to 65 
            when binarizing the gradient magnitude image. Below are the output images from thresholds of 10, 20, 30, and 65. 
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_edges_threshold-10.jpg" alt="Edge image (Threshold=10)" style="width: 250px; height: auto;" />
                <figcaption> Edge image (Threshold: 10) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_edges_threshold-20.jpg" alt="Edge image (Threshold=20)" style="width: 250px; height: auto;" />
                <figcaption> Edge image (Threshold: 20) </figcaption>
            </figure>
        </div>
        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_edges_threshold-30.jpg" alt="Edge image (Threshold=30)" style="width: 250px; height: auto;" />
                <figcaption> Edge image (Threshold: 30) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.2/cameraman_edges_threshold-65.jpg" alt="Edge image (Threshold=65)" style="width: 250px; height: auto;" />
                <figcaption> Edge image (Threshold: 65) </figcaption>
            </figure>
        </div>

        <p>
            At lower thresholds, I saw that the image has more noise but also displays more details other than just the cameraman, such as the specks 
            of grass and buildings in the background. As we increase the threshold, the edges are more focused on the main object of the photograph,
            which is the cameraman. Initially, I felt that threshold of 30 was a good choice as there was reduced noise in the background and the 
            edges mainly focused on the cameraman while retaining some background building information. However, upon applying the smoothing 
            operator later, I noticed that too much important information was removed at this threshold. Thus, I reduced the threshold and found 
            20 to be a good value where we can see a clear but whole outline of the cameraman, some outlines of the background building, and 
            there is not too much noise from the grass. I chose the outline of the cameraman over the background buildings as the cameraman is 
            the main object portrayed in the image and I believe it was more important for that to be clear rather than finding a balance but 
            having a lot of noise. 
        </p>
    </div>

    <h3> 1.3 Derivative of Gaussian (DoG) Filter </h3>
    <div>
        <p>
            Upon applying the Gaussian smoothing, the lines of the gradient magnitude look softer. There is less noise overall, especially of the 
            grass in the lower half of the image, but some details of the cameraman’s camera has also been removed. At the same threshold of 20, 
            we see a similar effect in the edge image. Compared to the edge image from using just the difference operators there is much less noise, 
            with practically none from the grass. The outline of the cameraman is also much more clear and the lines of the outline are thicker. 
            However, at the same time, edge details from the camera itself and more outlines of background buildings have been removed. Using the 
            DoG filter gives the same exact output as smoothing then convolving. Overall it still captures the image itself well though!
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.3/q1.3_smoothed_gradient_magnitude.jpg" alt="Edge image (Threshold=30)" style="width: 250px; height: auto;" />
                <figcaption> Gradient Magnitude (post-smoothing) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.3/q1.3_smoothed_edges.jpg" alt="Edge image (blur then binarize)" style="width: 250px; height: auto;" />
                <figcaption> Edge image w/ threshold 20 (blur → binarize) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/1.3/q1.3_smoothed_edges.jpg" alt="Edge image (DoG filter)" style="width: 250px; height: auto;" />
                <figcaption> Edge image w/ threshold 20 (DoG filter) </figcaption>
            </figure>
        </div>
    </div>

    <h2> Part 2: Fun with Frequencies! </h2>
    <h3> 2.1 Image "Sharpening" </h3>
        <p>
            For the step by step process with blur filters and high frequencies, I first blurred the Taj using a Gaussian 2D filter, which removes 
            the high frequency information. Then, subtracting the blurred version from the original image, it effectively captures the details that 
            were lost in the blur. By adding a scaled version of the high frequencies back to the original image, we ‘sharpen’ the image by the scaling 
            factor which makes the edges and details of the Taj appear more crisp. Below are each of the steps performed to sharpen the Taj.
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj.jpg" alt="Taj Original" style="width: 250px; height: auto;" />
                <figcaption> Taj Original </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj_blur.jpg" alt="Taj Blurred" style="width: 250px; height: auto;" />
                <figcaption> Taj Blurred </figcaption>
            </figure>
        </div>
        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj_high_freq.jpg" alt="Taj High Frequency" style="width: 250px; height: auto;" />
                <figcaption> Taj High Frequency </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj.jpg_sharpened_1.jpg" alt="Taj Sharpened" style="width: 250px; height: auto;" />
                <figcaption> Taj Sharpened </figcaption>
            </figure>
        </div>

        <p>
            I then created an unsharp mask filter, which is a filter that performs the exact same steps as described above, except combines the 
            blur and add into one single convolution operation using linearity properties of the equation. Overall, the unsharp mask filter 
            amplifies the high-frequency details of an image, such as the edges and texture, which makes the image seemingly ‘sharper’. The Taj 
            sharpened very quickly at alpha=1, but this same value didn’t have an obvious effect on other images of my choice. Thus, I played 
            around with the values and went as high as alpha=8 for a more obvious sharpening effect. 
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj.jpg_sharpened_1.jpg" alt="Plane Sharpened (⍺=1)" style="width: 250px; height: auto;" />
                <figcaption> Taj Sharpened (⍺=1) <p style="margin: 0px"> (w/ unsharp mask filter) </p> </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj.jpg_sharpened_2.jpg" alt="Plane Sharpened (⍺=2)" style="width: 250px; height: auto;" />
                <figcaption> Taj Sharpened (⍺=2) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/taj.jpg_sharpened_3.jpg" alt="Plane Sharpened (⍺=3)" style="width: 250px; height: auto;" />
                <figcaption> Taj Sharpened (⍺=3) </figcaption>
            </figure>
        </div>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane.jpg" alt="Plane View above Xinjiang, China " style="width: 250px; height: auto;" />
                <figcaption> Plane View above Xinjiang, China </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane.jpg_sharpened_1.jpg" alt="Plane Sharpened (⍺=1)" style="width: 250px; height: auto;" />
                <figcaption> Plane Sharpened (⍺=1) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane.jpg_sharpened_2.jpg" alt="Plane Sharpened (⍺=2)" style="width: 250px; height: auto;" />
                <figcaption> Plane Sharpened (⍺=2) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane.jpg_sharpened_6.jpg" alt="Plane Sharpened (⍺=6)" style="width: 250px; height: auto;" />
                <figcaption> Plane Sharpened (⍺=6) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane.jpg_sharpened_8.jpg" alt="Plane Sharpened (⍺=8)" style="width: 250px; height: auto;" />
                <figcaption> Plane Sharpened (⍺=8) </figcaption>
            </figure>
        </div>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/hk.JPG" alt="Hong Kong Victoria Harbour Night View" style="width: 250px; height: auto;" />
                <figcaption> Hong Kong Victoria Harbour Night View </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/hk.jpg_sharpened_1.jpg" alt="Hong Kong Sharpened (⍺=1)" style="width: 250px; height: auto;" />
                <figcaption> Hong Kong Sharpened (⍺=1) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/hk.jpg_sharpened_2.jpg" alt="Hong Kong Sharpened (⍺=2)" style="width: 250px; height: auto;" />
                <figcaption> Hong Kong Sharpened (⍺=2) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/hk.jpg_sharpened_6.jpg" alt="Hong Kong Sharpened (⍺=6)" style="width: 250px; height: auto;" />
                <figcaption> Hong Kong Sharpened (⍺=6) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/hk.jpg_sharpened_8.jpg" alt="Hong Kong Sharpened (⍺=8)" style="width: 250px; height: auto;" />
                <figcaption> Hong Kong Sharpened (⍺=8) </figcaption>
            </figure>
        </div>

        <p>
            For the evaluation image, I chose to blur the plane image after it was sharpened with alpha=2 then sharpen it again with alpha=2. 
            However, the output of the second-time sharpened image does not look the same as the initially sharpened one. The overall texture 
            of the image is still blurred and the high-frequency details that were removed during the blurring are not recovered by making it 
            sharper. It is sharper than the blurred image but not as sharp as the original sharpened image. 
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane.jpg_sharpened_2.jpg" alt="Plane Sharpened (⍺=2)" style="width: 250px; height: auto;" />
                <figcaption> Plane Original Sharpened (⍺=2) </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane_sharpened_blurred.JPG" alt="Plane Sharpened Image Blurred" style="width: 250px; height: auto;" />
                <figcaption> Plane Sharpened Image Blurred </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.1/plane_sharpened_blurred_alpha2.jpg_sharpened_2.jpg" alt=" Plane Second-time Sharpened (⍺=2)" style="width: 250px; height: auto;" />
                <figcaption> Plane Second-time Sharpened (⍺=2) </figcaption>
            </figure>
        </div>

    <h3> 2.2 Hybrid Images </h3>

        <p>
            To create the hybrid images, I combined the low frequency components of one image with the high frequency components of the other image. 
            Below is the entire process of how I created the hybrid of Derek and Nutmeg. Initially, simply passing images of Derek and Nutmeg into 
            the align_images function, I found that the images were aligned such that the output hybrid image would be rotated. Thus, I tried 
            switching the order that the images were passed in and was able to produce a more centered image. I found that aligning Nutmeg and 
            Derek by the center of their eyes as the two points produced the best aligned results. One challenge I ran into was that the 
            code would sometimes error that the image only had 2 channels. All images I was reading in were colored, thus I debugged by modifying 
            the rescale_images function to have channel_axis=2 when rescaling to keep the same number of color channels. To find the optimal cut off 
            frequencies, I tested out multiple values, such as having both frequencies to be the same, the low frequency cut off larger, and the 
            high frequency cut off larger. Below shows a few of the variety of values I tried out. Overall, I found the low frequency cut off at 7 
            and high frequency cut off at 6 worked best for this hybrid image.
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/DerekPicture.jpg" alt="Derek Original" style="width: 200px; height: auto;" />
                <figcaption> Derek Original </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/nutmeg.jpg" alt="Nutmeg Original" style="width: 300px; height: auto;" />
                <figcaption> Nutmeg Original </figcaption>
            </figure>
        </div>
        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_aligned.png" alt="Derek Aligned" style="width: 200px; height: auto;" />
                <figcaption> Derek Aligned </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/nutmeg_aligned.png" alt="Nutmeg Aligned" style="width: 300px; height: auto;" />
                <figcaption> Nutmeg Aligned </figcaption>
            </figure>
        </div>
        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_filtered.png" alt="Derek Filtered" style="width: 200px; height: auto;" />
                <figcaption> Derek Filtered </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/nutmeg_filtered.png" alt="Nutmeg Filtered" style="width: 300px; height: auto;" />
                <figcaption> Nutmeg Filtered </figcaption>
            </figure>
        </div>
        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/low=7,high=4.png" alt="Derek Filtered" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg + Derek Hybrid <p style="margin: 0px"> Low-frequency: 7, High-frequency: 4 </p></figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/low=10,high=5.png" alt="Derek Filtered" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg + Derek Hybrid <p style="margin: 0px"> Low-frequency: 10, High-frequency: 5 </p></figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/low=7,high=6_match_fft.png" alt="Derek Filtered" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg + Derek Hybrid <p style="margin: 0px"> Low-frequency: 7, High-frequency: 6 </p></figcaption>
            </figure>
        </div>

        <p> These are the log magnitude of the Fourier Transforms corresponding to low-freq cutoff = 7, high-freq cutoff = 6: </p>
        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_img1.jpg" alt="Derek Input FFT" style="width: 200px; height: auto;" />
                <figcaption> Derek Input Image FFT </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_img2.jpg" alt="Nutmeg Input FFT" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg Input Image FFT </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_img1_aligned.jpg" alt="Derek Aligned FFT" style="width: 200px; height: auto;" />
                <figcaption> Derek Aligned FFT </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_img2_aligned.jpg" alt="Nutmeg Aligned FFT" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg Aligned FFT </figcaption>
            </figure>
                        <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_img1_low_pass.jpg" alt="Derek Filtered FFT" style="width: 200px; height: auto;" />
                <figcaption> Derek Filtered FFT </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_img2_high_pass.jpg" alt="Nutmeg Filtered FFT" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg Filtered FFT </figcaption>
            </figure>
                <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/derek_nutmeg_fft/fft_hybrid.jpg" alt="Nutmeg + Derek Hybrid FFT" style="width: 200px; height: auto;" />
                <figcaption> Nutmeg + Derek Hybrid FFT </figcaption>
            </figure>
        </div>

        <p>
            At one point while I was playing around with the parameters, I accidentally switched the image order passed into the hybrid_image function. 
            This led to the below hybrid image which I found very funny at first glance as it looks like Nutmeg with human eyes and teeth!
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/acidentally_switched_hybrid_order.png" alt="Nutmeg with a human face!" style="width: 250px; height: auto;" />
                <figcaption> Nutmeg with a human face! (oops) </figcaption>
            </figure>
        </div>

        <p>
            Below are two other hybrid images I created. While creating these hybrid images I played around with the cut off frequencies more and 
            realized that in some cases a larger difference between the two frequencies worked better but sometimes the same cut off value for both 
            works better. The first one is a hybrid of my friend Sarah and I, where up close you will see Sarah but far away you will see me. The 
            second hybrid is of younger me versus a recent me. Close up you will see young Bonnie and further away you will see me at Stinson beach 
            taken last year. 
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/sarah.JPG" alt="My Friend Sarah" style="width: 250px; height: auto;" />
                <figcaption> My Friend Sarah </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/bonnie.jpg" alt="Myself (Bonnie)" style="width: 250px; height: auto;" />
                <figcaption> Myself </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/low=13,high=15.png" alt="Myself (Bonnie)" style="width: 250px; height: auto;" />
                <figcaption> Hybrid (Close: Sarah, Far: Bonnie) </figcaption>
            </figure>
        </div>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/baby2.JPG" alt="Baby me in Kindergarten" style="width: 250px; height: auto;" />
                <figcaption> Baby me in Kindergarten </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/bonnie2.jpg" alt="Me at Stinson Beach 2024 " style="width: 250px; height: auto;" />
                <figcaption> Me at Stinson Beach 2024 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.2/low=8,high=8.png" alt="Hybrid (Close: Young, Far: Now)" style="width: 250px; height: auto;" />
                <figcaption> Hybrid (Close: Young, Far: Now) </figcaption>
            </figure>
        </div>
    
    <h3> 2.3 & 2.4 Gaussian and Laplacian Stacks + Multiresolution Blending </h3>
        <p>
            To create the outcomes from this <a style="all: unset; color:rgb(35, 61, 255);" href="https://persci.mit.edu/pub_pdfs/spline83.pdf">paper</a>, I initially created a Gaussian stack which blurred the images increasingly. Below is the Gaussian 
            stack shown for levels 0, 2, and 4. 
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/gaussian_stack.png" alt="Apple and Orange Gaussian Stack" style="width: 500px; height: auto;" />
                <figcaption> Apple and Orange Gaussian Stack </figcaption>
            </figure>
        </div>

        <p>
            Then, to create the Laplacian stack, I subtracted each level of the gaussian stack by the level above 
            it. While applying the Gaussian and Laplacian stack initially, I masked the images right after I read it. However, that led to results 
            where there was a very clear cut border between the mask half and the image despite it being blurred. Thus, I realized I had to produce 
            a Gaussian and Laplacian stack of the mask as well, then apply it at each level of the Apple/Orange stack individually to produce the 
            most optimal outcome. The Laplacian stacks also looked very static when I initially created it despite the Gaussian stack looking 
            standard. I realized it was due to the output images having both positive and negative values. Upon applying normalization, the issue 
            was resolved. Below is a recreation of the outcomes of the Laplacian stack for the Oraple!
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/apple_l0.png" alt="Apple L0" style="width: 250px; height: auto;" />
                <figcaption> Apple L0 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/orange_L0.png" alt="Orange L0" style="width: 250px; height: auto;" />
                <figcaption> Orange L0 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/hybrid_l0.png" alt="Blend L0" style="width: 250px; height: auto;" />
                <figcaption> Blend L0 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/apple_l2.png" alt="Apple L2" style="width: 250px; height: auto;" />
                <figcaption> Apple L2 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/orange_l2.png" alt="Orange L2" style="width: 250px; height: auto;" />
                <figcaption> Orange L2 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/hybrid_l2.png" alt="Blend L2" style="width: 250px; height: auto;" />
                <figcaption> Blend L2 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/apple_l4.png" alt="Apple L4" style="width: 250px; height: auto;" />
                <figcaption> Apple L4 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/orange_l4.png" alt="Orange L4" style="width: 250px; height: auto;" />
                <figcaption> Orange L4 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/hybrid_l4.png" alt="Blend L4" style="width: 250px; height: auto;" />
                <figcaption> Blend L4 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/apple_half.png" alt="Apple Reconstructed" style="width: 250px; height: auto;" />
                <figcaption> Apple </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/orange_half.png" alt="Orange Reconstructed" style="width: 250px; height: auto;" />
                <figcaption> Orange </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/oraple.png" alt="Oraple" style="width: 250px; height: auto;" />
                <figcaption> Oraple </figcaption>
            </figure>
        </div>

        <p>
            For the custom blend, I love the view outside my window at Berkeley and noticed that there are so many colors during 
            different seasons. I have taken a bunch of photos of the view and have always been meaning to make a collage so this is the perfect 
            opportunity! In the first one, I blended the view of Summer and Fall. Initially, I hoped to blend it using a vertical seam, but it 
            was an unnatural blend due to the placement of the blinds and the window being open in one but not the other. Therefore, I tried 
            blending on the horizontal seam instead, with a mask that covers 2/3 summer and 1/3 Fall. I think it turned out super natural and 
            really love the result!
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/summer.jpg" alt="Summer outside window" style="width: 250px; height: auto;" />
                <figcaption> Summer outside window  </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/autumn.jpg" alt="Autumn outside window" style="width: 250px; height: auto;" />
                <figcaption> Autumn outside window </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/window_mask.jpg" alt="window mask" style="width: 275px; height: auto;" />
                <figcaption> Mask </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/window_gaussian_stack.jpg" alt="Window Gaussian Stack" style="width: 700px; height: auto;" />
                <figcaption> Window Gaussian Stack </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/summer_L0.png" alt="summer l0" style="width: 250px; height: auto;" />
                <figcaption> Summer L0  </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/Autumn_L0.png" alt="autumn l0" style="width: 250px; height: auto;" />
                <figcaption> Autumn L0 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/Blended_L0.png" alt="blend l0" style="width: 275px; height: auto;" />
                <figcaption> Blend L0 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/summer_L2.png" alt="summer l2" style="width: 250px; height: auto;" />
                <figcaption> Summer L2  </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/Autumn_L2.png" alt="autumn l2" style="width: 250px; height: auto;" />
                <figcaption> Autumn L2 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/Blended_L2.png" alt="blend l2" style="width: 275px; height: auto;" />
                <figcaption> Blend L2 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/summer_L4.png" alt="summer l4" style="width: 250px; height: auto;" />
                <figcaption> Summer L4  </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/Autumn_L4.png" alt="Atumn l4" style="width: 250px; height: auto;" />
                <figcaption> Autumn L4 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/Blended_L4.png" alt="blend l4" style="width: 275px; height: auto;" />
                <figcaption> Blend L4 </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/summer_reconstructed.png" alt="Summer" style="width: 250px; height: auto;" />
                <figcaption> Summer </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/autumn_reconstructed.png" alt="Autumn" style="width: 250px; height: auto;" />
                <figcaption> Autumn </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/blended_window_vertical.jpg" alt="Blended window" style="width: 250px; height: auto;" />
                <figcaption> Blended Window <p style="margin:0px"> (Top: Summer, Bottom: Autumn) </p></figcaption>
            </figure>
        </div>

        <p>
            I decided to be creative with the irregular mask blend. I saw the blend of an eye during class and thought it would be cool if I gave 
            myself a “third eye” by blending a close up image of my eye with a picture of myself. Finding the exact point of the eye was difficult 
            as I didn’t want any borders that made it look unnatural. Thus I zoomed in on my picture and drew the mask at exactly where I wanted 
            the eye to be then cropped the close up eye image to match the mask location exactly. Below is the result!
        </p>

        <div class="image-row" style="display: flex; justify-content: center; gap: 20px;">
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/bonnie_closeup.jpg" alt="close up image" style="width: 250px; height: auto;" />
                <figcaption> Close Up </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/eye.jpg" alt="eye image" style="width: 250px; height: auto;" />
                <figcaption> Eye </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/mask_eye.jpg" alt="mask" style="width: 250px; height: auto;" />
                <figcaption> Mask </figcaption>
            </figure>
            <figure style="flex: 0 0 auto; text-align: center;">
                <img src="./media/2.3/eye_on_forehead.png" alt="blend eye on forehead" style="width: 280px; height: auto;" />
                <figcaption> Eye on Forehead Blend </figcaption>
            </figure>
        </div>
</body>
</html>
